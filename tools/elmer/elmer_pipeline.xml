<tool id="elmer_pipeline" name="ELMER pipeline" version="1.0">
    <description>distal enhancer DNA methylation analysis and predict putative target genes, motif analysis
and identify regulatory transcription factors</description>
     <macros>
        <import>elmer_macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        Rscript ${__tool_directory__}/elmer_pipeline.R
        --meth_file="${methfile}"
        --rna_file="${rnafile}"
        --sample_info="${sampleinfo}" 
        ]]></command>
    <expand macro="minfi_config" />
    <inputs>
        
        <!-- Methylation data input -->
        <conditional name="methylation">
            <param name="inputtype" type="select" label="Select Methylation Data input type">
                <option value="manual">Upload manually generated methylation Beta values as a matrix</option>
                <option value="auto">Auto generate methyaltion matrix from IDAT files</option>
            </param>
            <when value="manual">
                <param format="csv" name="methdata" type="data" label="Beta values from data" help="see help section below for format description"/>
            </when>
            <when value="auto">
                <expand macro="minfi_input" />
            </when>
        </conditional>
        
        <!-- RNA seq data input -->
        <param format="csv" name="rnadata" type="data" label="Normalized expression data"/>

        <!-- Sample information input -->
        <param format="csv" name="sampleinformation" type="data" label="Sample information" />
    </inputs>
    <outputs>
        <data format="txt" name="report">
            <discover_datasets pattern="__designation_and_ext__" directory="./Result/${disease}/" visible="true" />
        </data>
    </outputs>
    <!--<tests>-->
        <!--<test>-->
            <!--<param name="methdata" value="methdata.csv"/>-->
            <!--<param name="rnadata" value="rnadata.csv" />-->
            <!--<param name="sampleinfo" value="sampleinfo.csv" />-->
            <!--<output name="output" file="complementBed_result1.bed" ftype="bed" />-->
        <!--</test>-->
    <!--</tests>-->
    <help>
**What it does:**

ELMER, uses only methylation and expression data, and does not require any chromatin conformation or ChIP-seq data. Furthermore, by identifying transcription factor binding motifs present within enhancers, and incorporating expression patterns of upstream transcription factors, ELMER is able to infer transcription factor networks activated in specific cancer subtypes.


**Input:**

450k data

RNA data

Sample information 

**Output:**

Complete ELMER results 

**How to use**

There are 3 main inputs needed to run ELMER via Galaxy, methylation matrix, gene expression matrix, sample information of the files. 



TODO: Example sample information file


    </help>
    <expand macro="citations" />
</tool>
